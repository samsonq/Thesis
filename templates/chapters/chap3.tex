%% This is an example first chapter.  You should put chapter/appendix that you
%% write into a separate file, and add a line \include{yourfilename} to
%% main.tex, where `yourfilename.tex' is the name of the chapter/appendix file.
%% You can process specific files by typing their names in at the 
%% \files=
%% prompt when you run the file main.tex through LaTeX.
\chapter{Deep Reinforcement Learning for Derivatives Pricing and Hedging}

\section{Motivations}
Previous work on derivatives pricing relies heavily on assumptions about the market and underlying stock movement to be consistent with theoretical standards for solving partial differential equations and deriving pricing models. For example, Monte Carlo simulations rely on the assumption that stock prices move according to a geometric Brownian motion stochastic process. As mentioned in Chapter 1, one of the most famous and widely-used options pricing models is the Black-Scholes Merton model. This framework is derived from a partial differential equation that also relies on many market condition assumptions that may not necessarily hold in real-world markets. For example, the model assumes through the optionâ€™s lifetime: no dividend payouts, constant risk-free interest rate, constant underlying volatility, and no transaction costs. The model also assumes the market has no-arbitrage conditions and there are no transaction costs.
\\ \\
However, these factors are all empirically dynamic and can affect underlying price movements and options premiums, but are not accounted for. These models serve as a good foundation for understanding some of the important factors that impact option prices, but in the real market, market dynamics can be affected by a large number of constantly changing factors. Many market frictions exist and are changing over time, which impact the value of financial derivatives. Furthermore, there are many types of different financial derivatives, each with unique properties, with options being one of the most popularly traded. A practical model would be developed on the basis of real market data that reflects the properties of market conditions on which the derivatives are traded, including transaction costs and other frictions.

\section{Derivatives Pricing Models}
To understand the fundamental ideas behind derivatives pricing and hedging, we first examine the theoretical approach with traditional options pricing models. As discussed in Chapter 1, the Black-Scholes model is the most widely-adopted foundation for understanding and analyzing option value and the factors that influence it. However, the model is not based on historical stocks and options data, but instead assumes the properties of stock price movement and makes many idealistic assumptions about market dynamics. Iterative improvements have been proposed to improve the framework, such as modeling using stochastic volatility as with the Heston model. Furthermore, derivatives pricing models have been developed for other types of assets other than equities, with different movement dynamics. 
\\ \\
For example, the Vasicek model is commonly used to model the evolution of interest rates to price interest rate derivatives. Another example is Black's model, an extension of the original Black-Scholes model, commonly used to price options on futures. Many models have been developed for various purposes and financial instruments, but they all rely on parametric assumptions instead of historical market data. This makes the basis of these models scientific, as the models are able to explain the specific factors that influence derivative prices, but potentially inaccurate as market dynamics are constantly changing. These models can also be applied in the context of devising hedging strategies to manage the risk of changes in the underlying factors.

\subsection{The Greeks}

Derivative prices are affected by a large number of variables that traders must constantly account for when developing trading and hedging strategies. There are some obvious factors that affect option prices that are captured, for example, by the Black-Scholes model: underlying price, time to expiration, volatility, and interest rate. The impact that a change in each of these aforementioned factors has on option prices is captured by the Greeks, which measure the sensitivity of option prices to these factors. Traditionally, traders and investors devised hedging strategies using the Greeks for the options they traded to account for the risk factors of option prices. Hence, various popular hedging methods used by many traders today include those such as delta hedging and gamma hedging, so that portfolios may remain delta or gamma neutral. The idea is to reduce the sensitivity of the options portfolio's value to underlying price movements as much as possible. A table of the most commonly-used Greeks and the corresponding definitions is displayed below.
\begin{table}[h]
\begin{center}
\begin{tabular}{c|c|c} 
\textbf{Greek} & \textbf{Value} & \textbf{Sensitivity to}\\[5pt]
$\Delta$ Delta & $\frac{\partial{V}}{\partial{S}}$ & Underlying Price\\[5pt]
$\Gamma$ Gamma & $\frac{\partial^2{V}}{\partial{S}^2}$ & Delta\\[5pt]
$\Theta$ Theta & $\frac{\partial{V}}{\partial{t}}$ & Time\\[5pt]
$\rho$ Rho & $\frac{\partial{V}}{\partial{r}}$ & Interest Rate\\[5pt]
$\nu$ Vega & $\frac{\partial{V}}{\partial{\sigma}}$ & Volatility\\[5pt]
\end{tabular}
\caption{The Greeks}
\end{center}
\end{table}
\\
\noindent The option pricing models previously discussed provide a method to derive these Greeks for various options. Using the Greeks to devise hedging strategies is a reasonable approach in the absence of sufficient data and computational capacity \cite{deep-hedging-ppt}. However, this approach to solving the hedging problem is not as efficient as it could be, given the recent advancements in data-driven machine learning methods. Nonetheless, the Greek-based method is still widely practiced as its idea is intuitive, which is to adjust positions to reduce the impact of changes in the impactful factors.

\subsection{Dynamic Delta-Hedging}

Perhaps the most practiced approach used for hedging is delta-hedging, which involves adjusting the hedge ratio of a derivative position in response to changes in the underlying asset price, which helps to reduce the risk exposure of the position. Since underlying asset prices, stock prices, for example, are dynamically changing over time, it is important to dynamically rebalance portfolio positions to 

\section{Deep Reinforcement Learning}

\subsubsection{Deep Learning}
Early concepts of deep learning have been present since the 1950s, such as perceptrons that could learn simple representations of data. However, because of the perceptron's limited complexity combined with limitations in data and computing abilities, deep learning technology did not become widely adopted by institutions until the 21st century. The core of deep learning lies in its ability to learn incredibly complex and abstract relationships, both linear and non-linear, from vast amounts of data and be able to make accurate predictions using the learned representation. Often when the amount of data is enormous and dimensionality is high, deep learning has proven to be effective compared to traditional forms of statistical learning.

\subsubsection{Reinforcement Learning}
Reinforcement learning is a method that overcomes many limitations of traditional machine learning. It involves exposing an agent to an environment with different states, available actions, corresponding rewards for those actions, and letting the agent learn to maximize rewards through a Markov decision process. This approach can be applied to a financial market environment with options trading with empirical economic and financial factors. The benefit of this approach is that it allows these factors to change dynamically across various time periods, which the agent will account for and gradually learn as it trains and explores the market environment. The power of reinforcement learning stems from its robustness and ability to quickly adapt to changing conditions relative to other types of machine learning methods.
\\
\\
In a simplified world with only a limited number of states of the market, traditional reinforcement learning may be used, since the state-action-reward combinations are easily computed. However, in environments such as the financial markets, there are a very large number of states, with combinations of different factors including risk-free rates, stock movements, costs, etc. To account for the complexity, this study examines the use of deep reinforcement learning methods to learn the states and rewards of the market by fitting a deep neural network on empirical data, and using the learned states and rewards to train a reinforcement learning agent.
\\
\\
The goal is to implement a deep reinforcement learning system that can accurately price derivatives and dynamically hedge given actual market conditions and market frictions. This can be done by using empirical data to learn the optimal policies for pricing and hedging through a policy gradient method. In the market environment, the agent will be given market conditions at each state and will incrementally learn the optimal hedging policy for correctly pricing derivatives and compute a P/L for the dynamic hedging strategy as a reward function. Furthermore, the agent will also be evaluated on return volatility and Sharpe ratio.

\subsection{Model-Free vs. Model-Based}

The increasing amount of available data and advancement in computing power has enabled machine learning algorithms to learn directly from empirical data and perform pattern recognition. Unlike the traditional methods previously described, machine learning methods do not rely on assumptions of the underlying data-generating process, but instead, try to learn the data-generating process based on observed data. It has been shown that machine learning can outperform traditional methods for many tasks including fields in computer vision, natural language processing, and time-series forecasting. This study examines the application of machine learning algorithms to financial derivatives analysis by trying to learn the optimal options pricing and dynamic hedging strategy based on data. Reinforcement learning provides a good foundation for such a task. The goal of this research is to explore methodologies in derivatives pricing and hedging strategies, and to propose a data-driven approach using multi-agent systems to optimize financial objectives.

\subsection{Multi-Agent Reinforcement Learning}

\subsection{Inverse Reinforcement Learning}

\section{Derivatives Pricing with Deep Reinforcement Learning}

\section{Deep Hedging}

\subsection{The Hedging Problem}

Portfolios are constantly subject to a variety of risk factors that may significantly impact the portfolio's value and cause high volatility in returns. Hedging is a popular method to combat the risk that subjugates portfolios. The main idea behind this approach is to reduce risk and volatility by taking an offsetting position in another asset, such as a derivative of the underlying. However, hedging can be costly in a market with transaction costs and other frictions, along with the financial constraints of various investors. An effective hedging strategy must not only account for all the transaction costs involved but also all other imposed constraints.

\subsection{Applying Deep Reinforcement Learning to Hedging}

Deep hedging is a systematic framework for using deep reinforcement learning to learn the optimal policy for derivatives pricing and dynamic hedging based on the aggregation of market data. Deep hedging agents learn to dynamically adjust a portfolio's hedges in response to changing market conditions, which can make the algorithm significantly more robust and precise compared to traditional Greek hedging methods. The goal of deep hedging is to minimize the overall risk of a portfolio by continuously adjusting the level of hedging in response to changes in the value of the underlying assets. This involves the use of derivatives such as options and futures to hedge against potential losses in the portfolio by trying to minimize the portfolio's risk. As machine learning methods are powered by data, this framework can be applied to a wide range of financial assets, including stocks, bonds, commodities, and currencies.
\\
\\
Reinforcement learning is an appropriate tool for the task of hedging because it can be adapted to work with different combinations of market conditions, portfolio complexities, and investment objectives. Unlike traditional optimization tasks, reinforcement learning agents remove the need to manually solve for optimal positions by interacting and learning the optimal strategy directly from a realistic market environment through trial and error. At a high level, deep hedging uses deep neural networks to predict the evolution of the markets and then uses this prediction to allow agents to learn how to dynamically adjust a portfolio's hedge positions to minimize risk.

\subsection{Using GAN-Generated Synthetic Market Data}

As explored in Chapter 2, GANs can be applied to the deep hedging framework by generating a diverse range of synthetic market scenarios that can be used to stress-test the hedging algorithms. The synthetic data that the GAN generates has statistical properties resembling real data. This data can be used to help ensure that the hedging algorithm is robust and can handle a wide range of market conditions. GANs can be used to augment the training data for the hedging algorithm by generating additional synthetic data points that are representative of the real-world market. This can help to improve the performance of the hedging algorithm by increasing the amount and diversity of training data available.

\subsection{Training Deep Hedging Agents}

\subsection{Dynamic Hedging Strategies with Deep Hedging}

\section{Evaluating Deep Hedging Algorithms}

\subsection{Using Data from Stochastic Models vs. GANs}

\subsection{Comparing Performance to Greek Methods}
 